<!-- templates/edit_news.html -->
{% extends "base.html" %}
{% block title %}Редактировать новость{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Редактировать новость</h1>
    <div class="user-info">
        <a href="{{ url_for('manage_news') }}" class="btn btn-secondary btn-sm">
            <i class="bi bi-arrow-left me-1"></i>Назад к списку
        </a>
    </div>
</div>

<div class="card shadow-sm">
    <div class="card-body">
        <form method="POST" action="{{ url_for('edit_news', news_id=news.id) }}">
            <div class="mb-3">
                <label for="title" class="form-label">Заголовок <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="title" name="title" required maxlength="255" value="{{ news.title }}">
            </div>
            
            <div class="mb-3">
                <label for="body" class="form-label">Текст новости <span class="text-danger">*</span></label>
                <textarea class="form-control" id="body" name="body" rows="10" required>{{ news.body }}</textarea>
                <small class="form-text text-muted">Используйте панель инструментов для форматирования текста. Поддерживается HTML-разметка.</small>
            </div>
            
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="pinned" name="pinned" {% if news.pinned %}checked{% endif %}>
                    <label class="form-check-label" for="pinned">
                        <i class="bi bi-pin-angle-fill"></i> Закрепить новость (будет отображаться сверху списка)
                    </label>
                    <small class="form-text text-muted d-block">Если закрепить новость, закрепление с предыдущей будет снято.</small>
                </div>
            </div>
            
            <div class="mb-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="stiker" name="stiker" {% if news.stiker %}checked{% endif %}>
                    <label class="form-check-label" for="stiker">
                        Активна (отображать на главной странице)
                    </label>
                </div>
            </div>
            
            <div class="mb-3">
                <small class="text-muted">Дата создания: {{ news.dt.strftime('%d.%m.%Y %H:%M:%S') }}</small>
            </div>
            
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle me-1"></i>Сохранить изменения
                </button>
                <a href="{{ url_for('manage_news') }}" class="btn btn-secondary">Отмена</a>
            </div>
        </form>
    </div>
</div>

<!-- TinyMCE Editor -->
<script src="{{ url_for('static', filename='js/tinymce.min.js') }}"></script>
<script>
    tinymce.init({
        selector: '#body',
        language: 'ru',
        height: 400,
        menubar: false,
        plugins: [
            'advlist', 'autolink', 'lists', 'link', 'image', 'charmap', 'preview',
            'anchor', 'searchreplace', 'visualblocks', 'code', 'fullscreen',
            'insertdatetime', 'media', 'table', 'code', 'help', 'wordcount'
        ],
        toolbar: 'undo redo | blocks | ' +
            'bold italic forecolor | alignleft aligncenter ' +
            'alignright alignjustify | bullist numlist outdent indent | ' +
            'removeformat | link image | code | help',
        content_style: 'body { font-family: Arial, sans-serif; font-size: 14px; }',
        branding: false,
        promotion: false
    });
</script>
{% endblock %}

