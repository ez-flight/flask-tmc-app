# Тестовый режим работы приложения

## Описание

Тестовый режим позволяет просматривать и тестировать сайт без подключения к реальной базе данных. Используются мок-данные пользователей.

## Включение тестового режима

### Вариант 1: Через переменную окружения (рекомендуется)

Добавьте в файл `.env`:
```
TEST_MODE=true
```

После этого перезапустите приложение, чтобы изменения вступили в силу.

### Вариант 2: Через командную строку

```bash
TEST_MODE=true python app.py
```

## Тестовые пользователи

В тестовом режиме доступны следующие пользователи (информация отображается на странице авторизации):

| Логин | Пароль | Роль | Описание |
|-------|--------|------|----------|
| `admin` | `test123` | Администратор | Полный доступ ко всем функциям |
| `mol` | `test123` | МОЛ | Материально-ответственное лицо |
| `user` | `test123` | Пользователь | Обычный пользователь |
| `test` | `test123` | МОЛ | Тестовый пользователь с правами МОЛ |

**Примечание**: Все пользователи используют один и тот же пароль `test123` для упрощения тестирования.

## Особенности тестового режима

### Авторизация
- Используются мок-пользователи из модуля `test_mode.py`
- Проверка пароля упрощена (простое сравнение строк)
- Логин и пароль нормализуются (удаляются пробелы, приводится к нижнему регистру)
- На странице входа отображается информационное сообщение с перечнем тестовых пользователей

### Отображение данных
- **Статистика и данные ТМЦ**: Не загружаются из БД (показываются нули или пустые списки)
- **Организация**: Отображается "Тестовая организация"
- **Фото пользователя**: Используется стандартное изображение `noimage.jpg`
- **Списки**: Все списки (ТМЦ, пользователи, накладные, перемещения и т.д.) возвращают пустые данные

### Ограничения
- **Редактирование данных**: Все операции создания, редактирования и удаления заблокированы с предупреждающими сообщениями:
  - Управление пользователями
  - Добавление/редактирование комплектующих
  - Создание/редактирование накладных
  - Создание/редактирование новостей
  - Выдача/возврат ТМЦ
- **Запросы к БД**: Все запросы к базе данных для получения данных заменяются на мок-данные или пустые результаты

## Защищенные маршруты

В тестовом режиме следующие маршруты возвращают пустые данные или заблокированы:

### Просмотр (пустые данные):
- `/all_tmc` - Просмотр всего имущества
- `/my_tmc` - Мои ТМЦ
- `/list_by_nome/<nome_id>` - Список ТМЦ по группе
- `/all_stats` - Статистика (админ)
- `/my_stats` - Моя статистика
- `/all_moves` - Последние перемещения
- `/my_moves` - Мои перемещения
- `/all_components` - Комплектующие
- `/invoice_list` - Список накладных
- `/my_temp_tmc` - Полученные ТМЦ
- `/my_friends` - Мои друзья
- `/my_departments` - Мои отделы
- `/manage_users` - Управление пользователями
- `/manage_news` - Управление новостями
- `/manage_categories` - Управление категориями
- `/friend_equipment/<user_id>` - Оборудование друга

### Заблокированные операции:
- `/edit_user/<user_id>` - Редактирование пользователя
- `/add_component` - Добавление комплектующего
- `/edit_component/<component_id>` - Редактирование комплектующего
- `/create_invoice` - Создание накладной
- `/edit_invoice/<invoice_id>` - Редактирование накладной
- `/delete_invoice/<invoice_id>` - Удаление накладной
- `/invoice/<invoice_id>` - Просмотр накладной
- `/add_news` - Добавление новости
- `/edit_news/<news_id>` - Редактирование новости
- `/delete_news/<news_id>` - Удаление новости
- `/temp_assign` - Выдача ТМЦ
- `/temp_return/<usage_id>` - Возврат ТМЦ

## Отключение тестового режима

Удалите `TEST_MODE=true` из `.env` или установите:
```
TEST_MODE=false
```

После этого перезапустите приложение.

## Технические детали

- Флаг тестового режима проверяется в начале каждого маршрута
- Мок-пользователи создаются в модуле `test_mode.py`
- Все запросы к БД обернуты в проверку `if TEST_MODE:`
- В тестовом режиме `load_user` возвращает мок-объекты вместо запросов к БД
- Функция `current_user_has_role` проверяет роли из мок-объекта в тестовом режиме

## Примечания

- Тестовый режим предназначен только для демонстрации и тестирования интерфейса
- Все данные в тестовом режиме являются фиктивными
- Не используйте тестовый режим в продакшене
- При переключении между тестовым и реальным режимом требуется перезапуск приложения

