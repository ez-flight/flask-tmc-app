# –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤ Jinja2

## üìä –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–±–ª–æ–Ω–æ–≤:** 33+ —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ `templates/`

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –°–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —à–∞–±–ª–æ–Ω
- ‚ùå –ù–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
- ‚ùå –ü—Ä–∏ —Ä–æ—Å—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞ –±—É–¥–µ—Ç –µ—â–µ —Å–ª–æ–∂–Ω–µ–µ
- ‚ùå –°–º–µ—à–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤ (HTML + –º–∏–≥—Ä–∞—Ü–∏–∏ Python)

## ‚úÖ –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
templates/
‚îú‚îÄ‚îÄ base.html                    # –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω (–æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ)
‚îú‚îÄ‚îÄ auth/                        # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ login.html
‚îÇ
‚îú‚îÄ‚îÄ tmc/                         # –¢–ú–¶ (–æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ index.html               # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ add_tmc.html
‚îÇ   ‚îú‚îÄ‚îÄ edit_tmc.html
‚îÇ   ‚îú‚îÄ‚îÄ info_tmc.html
‚îÇ   ‚îú‚îÄ‚îÄ list_by_nome.html
‚îÇ   ‚îú‚îÄ‚îÄ all_tmc.html
‚îÇ   ‚îî‚îÄ‚îÄ my_tmc.html
‚îÇ
‚îú‚îÄ‚îÄ nomenclature/                # –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ add_nome.html
‚îÇ   ‚îú‚îÄ‚îÄ edit_nome.html
‚îÇ   ‚îú‚îÄ‚îÄ bulk_edit_nome.html
‚îÇ   ‚îî‚îÄ‚îÄ edit_nome_group.html
‚îÇ
‚îú‚îÄ‚îÄ components/                   # –ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ all_components.html
‚îÇ   ‚îú‚îÄ‚îÄ add_component.html
‚îÇ   ‚îî‚îÄ‚îÄ edit_component.html
‚îÇ
‚îú‚îÄ‚îÄ users/                       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ manage_users.html
‚îÇ   ‚îú‚îÄ‚îÄ edit_user.html
‚îÇ   ‚îî‚îÄ‚îÄ edit_my_profile.html
‚îÇ
‚îú‚îÄ‚îÄ invoices/                    # –ù–∞–∫–ª–∞–¥–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ invoice_list.html
‚îÇ   ‚îú‚îÄ‚îÄ create_invoice.html
‚îÇ   ‚îú‚îÄ‚îÄ edit_invoice.html
‚îÇ   ‚îî‚îÄ‚îÄ invoice_detail.html
‚îÇ
‚îú‚îÄ‚îÄ temp_usage/                  # –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞
‚îÇ   ‚îú‚îÄ‚îÄ my_temp_tmc.html
‚îÇ   ‚îú‚îÄ‚îÄ my_friends.html
‚îÇ   ‚îî‚îÄ‚îÄ friend_equipment.html
‚îÇ
‚îú‚îÄ‚îÄ reports/                     # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ stats.html
‚îÇ   ‚îú‚îÄ‚îÄ all_moves.html
‚îÇ   ‚îî‚îÄ‚îÄ my_moves.html
‚îÇ
‚îú‚îÄ‚îÄ news/                        # –ù–æ–≤–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ manage_news.html
‚îÇ   ‚îú‚îÄ‚îÄ add_news.html
‚îÇ   ‚îî‚îÄ‚îÄ edit_news.html
‚îÇ
‚îî‚îÄ‚îÄ admin/                       # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îî‚îÄ‚îÄ manage_categories.html
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- –°–≤—è–∑–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Ä—è–¥–æ–º
- –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—Ä–æ—â–µ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —Ñ–∞–π–ª

### 2. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ª–µ–≥–∫–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–∞–ø–∫—É
- –ù–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–π –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏
- –£–¥–æ–±–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –∫–æ–º–∞–Ω–¥–µ

### 3. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–¥–∞
- –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- –õ–µ–≥—á–µ –ø–æ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —à–∞–±–ª–æ–Ω–∞–º–∏
- –ü—Ä–æ—â–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 4. –ß–∏—Å—Ç–æ—Ç–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –û—Ç–¥–µ–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –æ—Ç —à–∞–±–ª–æ–Ω–æ–≤
- –ë–æ–ª–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ best practices

## üìù –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å

### 1. –û–±–Ω–æ–≤–∏—Ç—å `render_template()` –≤—ã–∑–æ–≤—ã

**–ë—ã–ª–æ:**
```python
return render_template('add_tmc.html', ...)
```

**–°—Ç–∞–ª–æ:**
```python
return render_template('tmc/add_tmc.html', ...)
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å `{% extends %}` –≤ —à–∞–±–ª–æ–Ω–∞—Ö

**–ë—ã–ª–æ:**
```jinja2
{% extends "base.html" %}
```

**–û—Å—Ç–∞–µ—Ç—Å—è:**
```jinja2
{% extends "base.html" %}  # –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –≤ –∫–æ—Ä–Ω–µ, –ø—É—Ç—å –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
```

### 3. –û–±–Ω–æ–≤–∏—Ç—å `{% include %}` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

**–ë—ã–ª–æ:**
```jinja2
{% include "partial.html" %}
```

**–°—Ç–∞–ª–æ:**
```jinja2
{% include "partials/partial.html" %}  # –ï—Å–ª–∏ —Å–æ–∑–¥–∞–¥–∏—Ç–µ –ø–∞–ø–∫—É partials
```

## üîÑ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
```bash
cd /home/flask_tmc_app/templates
mkdir -p auth tmc nomenclature components users invoices temp_usage reports news admin
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã
```bash
# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
mv login.html auth/

# –¢–ú–¶
mv index.html add_tmc.html edit_tmc.html info_tmc.html list_by_nome.html all_tmc.html my_tmc.html tmc/

# –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞
mv add_nome.html edit_nome.html bulk_edit_nome.html edit_nome_group.html nomenclature/

# –ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ
mv all_components.html add_component.html edit_component.html components/

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
mv manage_users.html edit_user.html edit_my_profile.html users/

# –ù–∞–∫–ª–∞–¥–Ω—ã–µ
mv invoice_list.html create_invoice.html edit_invoice.html invoice_detail.html invoices/

# –í—Ä–µ–º–µ–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞
mv my_temp_tmc.html my_friends.html friend_equipment.html temp_usage/

# –û—Ç—á–µ—Ç—ã
mv stats.html all_moves.html my_moves.html reports/

# –ù–æ–≤–æ—Å—Ç–∏
mv manage_news.html add_news.html edit_news.html news/

# –ê–¥–º–∏–Ω
mv manage_categories.html admin/
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–∏—Ç—å app.py

–ù–∞–π—Ç–∏ –∏ –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `render_template()` –≤—ã–∑–æ–≤—ã:

```python
# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –≤—ã–∑–æ–≤–æ–≤
grep -n "render_template" app.py

# –ó–∞–º–µ–Ω–∞ (–ø—Ä–∏–º–µ—Ä—ã):
'login.html' ‚Üí 'auth/login.html'
'add_tmc.html' ‚Üí 'tmc/add_tmc.html'
'edit_tmc.html' ‚Üí 'tmc/edit_tmc.html'
# –∏ —Ç.–¥.
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π –≤–Ω–µ templates
mkdir -p migrations

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å Python —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
mv templates/migrate_*.py migrations/
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### Flask –∏ –ø—É—Ç–∏ –∫ —à–∞–±–ª–æ–Ω–∞–º

Flask –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —à–∞–±–ª–æ–Ω—ã –≤ –ø–∞–ø–∫–µ `templates/`, –ø–æ—ç—Ç–æ–º—É:
- ‚úÖ `render_template('tmc/add_tmc.html')` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `render_template('auth/login.html')` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `render_template('base.html')` - —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –≤ –∫–æ—Ä–Ω–µ templates/)

### –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω

`base.html` –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ `templates/`, —Ç–∞–∫ –∫–∞–∫:
- –í—Å–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –æ—Ç –Ω–µ–≥–æ
- –ü—É—Ç—å `{% extends "base.html" %}` –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è
- –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `url_for()` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –Ω–∞ —à–∞–±–ª–æ–Ω—ã (—á—Ç–æ —Ä–µ–¥–∫–æ), –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å.

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏

–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:

```python
# migrate_templates.py
import os
import shutil
import re

# –ú–∞–ø–ø–∏–Ω–≥ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–∞–ø–∫–∏
MAPPING = {
    'login.html': 'auth/',
    'index.html': 'tmc/',
    'add_tmc.html': 'tmc/',
    'edit_tmc.html': 'tmc/',
    # ... –∏ —Ç.–¥.
}

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ app.py
def update_app_py():
    with open('app.py', 'r', encoding='utf-8') as f:
        content = f.read()
    
    for old_path, new_path in MAPPING.items():
        old = f"render_template('{old_path}'"
        new = f"render_template('{new_path}{old_path}'"
        content = content.replace(old, new)
    
    with open('app.py', 'w', encoding='utf-8') as f:
        f.write(content)
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **–§–∞–π–ª–æ–≤ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:** ~33
- **–°—Ç—Ä–æ–∫ –≤ app.py –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** ~19
- **–í—Ä–µ–º—è –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—é:** 15-30 –º–∏–Ω—É—Ç
- **–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–ª–µ–≥–∫–æ –æ—Ç–∫–∞—Ç–∏—Ç—å)

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ê, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ —Å—Ç–æ–∏—Ç —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å!**

–ü—Ä–∏—á–∏–Ω—ã:
1. ‚úÖ –£–∂–µ 33+ —Ñ–∞–π–ª–∞ - –ø–æ—Ä–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å
2. ‚úÖ –£–ª—É—á—à–∏—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É
3. ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç best practices
4. ‚úÖ –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –≤ –±—É–¥—É—â–µ–º
5. ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–∏–¥ –ø—Ä–æ–µ–∫—Ç–∞

**–ö–æ–≥–¥–∞ –¥–µ–ª–∞—Ç—å:**
- –°–µ–π—á–∞—Å, –ø–æ–∫–∞ –ø—Ä–æ–µ–∫—Ç –Ω–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
- –ü–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ü—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –∫–æ–¥–∞

**–ö–∞–∫ –¥–µ–ª–∞—Ç—å:**
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (–ø–æ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
- –ò–ª–∏ —Å—Ä–∞–∑—É –≤—Å–µ (–±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)
- –° –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

